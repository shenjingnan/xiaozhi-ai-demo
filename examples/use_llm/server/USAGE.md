# ESP32-LLM 语音助手使用指南

## 快速开始

### 1. 启动服务器
```bash
./start_server.sh
```
或者：
```bash
/Users/nemo/.pyenv/versions/3.13.2/bin/python server.py
```

### 2. 启动客户端
```bash
./start_client.sh
```
或者：
```bash
/Users/nemo/.pyenv/versions/3.13.2/bin/python client.py
```

### 3. 使用客户端

启动后会看到交互界面：
```
=== Python语音助手测试客户端 ===
输入命令:
  start      - 开始对话 (默认5秒录音)
  start 10   - 开始对话 (录音10秒)
  quick      - 快速测试 (3秒录音)
  quit       - 退出

> 
```

## 使用示例

### 基本对话（5秒录音）
```
> start
🎤 对话已开始，请说话... (将录制 5 秒)
⏱️  录音中... 剩余 5 秒
⏱️  录音中... 剩余 4 秒
...
⏹️  录音时间结束
🤖 录音已停止，正在请求AI回复...
📝 语音识别: 你好
💬 AI文本回复: 你好！有什么可以帮助您的吗？
🔊 收到AI音频回复，正在播放...
✓ AI回复播放完成
```

### 快速测试（3秒录音）
```
> quick
🎤 对话已开始，请说话... (将录制 3 秒)
...
```

### 自定义录音时长
```
> start 8
🎤 对话已开始，请说话... (将录制 8 秒)
...
```

## 功能特点

- ✅ **自动录音停止**：无需手动干预，自动停止录音
- ✅ **实时倒计时**：清楚显示剩余录音时间
- ✅ **语音识别**：显示您说话的文字内容
- ✅ **AI文本回复**：显示AI的文字回复
- ✅ **音频播放**：播放AI的语音回复
- ✅ **可调时长**：支持1-30秒的录音时长

## 技术细节

- **音频参数**：16kHz采样率，单声道，16位深度
- **协议**：WebSocket通信
- **AI模型**：Qwen Omni Turbo Realtime
- **编码**：音频数据使用Base64编码传输

## 故障排除

### 服务器连接失败
- 检查服务器是否正在运行
- 确认8888端口未被占用
- 验证API密钥是否正确设置

### 音频设备问题
- 确认麦克风权限已授权
- 检查音响/耳机是否正常工作
- macOS可能需要在系统偏好设置中授权音频权限

### Python环境问题
- 确保使用Python 3.13环境
- 安装必要依赖：`pip install websockets==12.0 pyaudio`